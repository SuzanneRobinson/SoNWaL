
###get parameters
getParms<-function(weather=clm_df_full,
                   ## ~~ Initial pools ~~ ##
                   Wl = 0.01,
                   WlDormant = 0,
                   Wr = 0.01,
                   Wsbr = 0.1,
                   Wlitt = 0,# could be real small?
                   YrC = 47.97,
                   YlC = 95.94,
                   OC = 335.78,
                   YrN = 2.02,
                   YlN = 4.05,
                   ON = 14.7,
                   Nav = 12.4,
                   ## ~~ Site ~~ ##
                   N = 2000,
                   rotation = 1,
                   cycle = 1,
                   rm.sprouts = F,
                   nyears = 35,
                   initial.month = 1,
                   latitude = 57.06,
                   soilclass = -1,
                   ASW = 165,
                   MaxASW = 500,
                   MinASW = 0,
                   CO2 = 400,
                   ## ~~ Parameters ~~ ##
                   pFS2 = 0.979729182866315,
                   pFS20 = 0.450083704735021,
                   aS = 0.041517998716385,
                   nS = 2.64745625287154,
                   pRx = 0.637320766593578,
                   pRn = 0.285132846643722,
                   Tmin = -5,
                   Topt = 15,
                   Tmax = 35,
                   kF = 1,
                   SWconst0 = 0.3,
                   SWpower0 = 4,
                   m0 = 0.392548265174109,
                   MaxAge = 265.6,
                   nAge = 3.545,
                   rAge = 0.796,
                   gammaFx = 0.01888,
                   gammaF0 = 0.001,
                   tgammaF = 60,
                   Rttover = 0.1,
                   MaxCond = 0.02,
                   LAIgcx = 1.97882119903727,
                   BLcond = 0.102217047783467,
                   wSx1000 = 500,
                   thinPower = 1.5,
                   mF = 0.633672385962458,
                   mR = 0.650445331850193,
                   mS = 0.2,
                   SLA0 = 3.85479046435674,
                   SLA1 = 5.33472018885286,
                   tSLA = 3.94078881883446,
                   k = 0.5,
                   fullCanAge = 18,
                   MaxIntcptn = 0.1,
                   LAImaxIntcptn = 5,
                   alpha = 0.06,
                   Y = 0.633301670948344,
                   poolFractn = 0,
                   e20 = 2.2,
                   rhoAir = 1.2,
                   lambda = 2460000,
                   VPDconv = 0.000622,
                   fracBB0 = 0.3,
                   fracBB1 = 0.1,
                   tBB = 10,
                   rhoMin = 0.39,
                   rhoMax = 0.39,
                   tRho = 5,
                   Qa = -50,
                   Qb = 0.8,
                   gDM_mol = 24,
                   molPAR_MJ = 2.3,
                   CoeffCond = 0.09986604057721,
                   fCalpha700 = 1.433,
                   fCg700 = 0.451,
                   fCalphax = 2.33333333333333,
                   fCg0 = 1.75,
                   MinCond = 0.005,
                   klmax = 0.06903041028657,
                   krmax = 0.007021449543068,
                   komax = 0.00840935020844,
                   hc = 0.494539540825284,
                   qir = 148.092408851735,
                   qil = 14.9377246340992,
                   qh = 40.4572399963215,
                   qbc = 7.00578471546651,
                   el = 0.739904866285297,
                   er = 0.769592209202898,
                   Nf = 0.0196791366844,
                   Navm = 0.032129816636208,
                   Navx = 8.75614468799907,
                   leaf.grow = 0,
                   leaf.fall = 0,
                   Wl.s = 0.01,
                   Wsbr.s = 0.1,
                   Wr.s = 0.01,
                   pWl.sprouts = 0.5,
                   pWsbr.sprouts = 0.9,
                   cod.pred = "3PG",
                   cod.clim = "Month",
                   ## ~~ Almedia et al. Parameters ~~ ##
                   waterBalanceSubMods =T, #Whether to run model using updated water balance submodels
                   wiltPoint = 0.14, #Wilting point in m^3/m^3? need to convert to mm per meter with rooting depth?
                   fieldCap =0.2,#Field capacity
                   satPoint= 0.35, #field saturation point
                   K_s=0.5, #Soil conductivity
                   shared_area=4, #shared area of rooting and non-rooting zone
                   V_nr=1, #Volume of non-rooting zone
                   maxRootDepth=1,
                   sigma_zR =1.5, #area/depth explored by 1kg of root biomass
                   SWC_nr=10, #SWC of non-rooting zone at time 0
                   E_S1 =0.3, #Cumulitive evap threshold (kg^m-2) - sensitive to length of time-step, e.g. monthly time-step means wetting event only occurs at end of month
                   E_S2 =0.6, #how quickly evaporation rate declines with accumulated phase 2 evaporation - based on soil structure
                   MaxASW_state=50,
                   K_drain=0.5,
                   timeStp = 12, # time step, 52 for weekly, 12 for monthly and 365 for daily
                   rainMod =1, #rain adjustment for sensitivity analyses
                   tempMod =1, #rain adjustment for sensitivity analyses
                   fsMod=1,
                   startN=12,
                   startC=400,
                   pseudo=F #whether to use pseudo time-steps
                   ){
  
 list(weather=weather,
              ## ~~ Initial pools ~~ ##
              Wl =Wl ,
              WlDormant =WlDormant ,
              Wr =Wr ,
              Wsbr =Wsbr ,
              Wlitt =Wlitt ,
              YrC =YrC ,
              YlC =YlC ,
              OC =OC ,
              YrN =YrN ,
              YlN =YlN ,
              ON =ON ,
              Nav =Nav ,
              ## ~~ Site ~
              N =N ,
              rotation =rotation ,
              cycle =cycle ,
              rm.sprouts =rm.sprouts ,
              nyears =nyears ,
              initial.month =initial.month ,
              latitude =latitude ,
              soilclass = soilclass,
              ASW =ASW ,
              MaxASW =MaxASW ,
              MinASW =MinASW ,
              CO2 =CO2 ,
              ## ~~ Parameters ~
              pFS2 =pFS2 ,
              pFS20 =pFS20 ,
              aS =aS ,
              nS =nS ,
              pRx =pRx ,
              pRn =pRn ,
              Tmin = Tmin,
              Topt =Topt ,
              Tmax =Tmax ,
              kF =kF ,
              SWconst0 =SWconst0 ,
              SWpower0 =SWpower0 ,
              m0 =m0 ,
              MaxAge =MaxAge ,
              nAge =nAge ,
              rAge =rAge ,
              gammaFx =gammaFx ,
              gammaF0 =gammaF0 ,
              tgammaF =tgammaF ,
              Rttover =Rttover ,
              MaxCond =MaxCond ,
              LAIgcx =LAIgcx ,
              BLcond =BLcond ,
              wSx1000 =wSx1000 ,
              thinPower =thinPower ,
              mF =mF ,
              mR =mR ,
              mS =mS ,
              SLA0 =SLA0 ,
              SLA1 =SLA1 ,
              tSLA =tSLA ,
              k =k ,
              fullCanAge =fullCanAge ,
              MaxIntcptn =MaxIntcptn ,
              LAImaxIntcptn =LAImaxIntcptn ,
              alpha =alpha ,
              Y =Y ,
              poolFractn =poolFractn ,
              e20 =e20 ,
              rhoAir =rhoAir ,
              lambda =lambda ,
              VPDconv =VPDconv ,
              fracBB0 =fracBB0 ,
              fracBB1 =fracBB1 ,
              tBB =tBB ,
              rhoMin =rhoMin ,
              rhoMax =rhoMax ,
              tRho =tRho ,
              Qa = Qa,
              Qb =Qb ,
              gDM_mol =gDM_mol ,
              molPAR_MJ =molPAR_MJ ,
              CoeffCond =CoeffCond ,
              fCalpha700 =fCalpha700 ,
              fCg700 =fCg700 ,
              fCalphax =fCalphax,
              fCg0 =fCg0 ,
              MinCond =MinCond ,
              klmax =klmax ,
              krmax =krmax ,
              komax =komax ,
              hc =hc ,
              qir =qir ,
              qil =qil ,
              qh =qh ,
              qbc =qbc ,
              el =el ,
              er =er ,
              Nf =Nf ,
              Navm =Navm ,
              Navx =Navx ,
              leaf.grow =leaf.grow ,
              leaf.fall =leaf.fall ,
              Wl.s =Wl.s ,
              Wsbr.s =Wsbr.s ,
              Wr.s =Wr.s ,
              pWl.sprouts =pWl.sprouts ,
              pWsbr.sprouts =pWsbr.sprouts ,
              cod.pred = cod.pred,
              cod.clim = cod.clim,
              ## ~~ Almedia et al. Parameters ~~ ##
              waterBalanceSubMods =waterBalanceSubMods, #Whether to run model using updated water balance submodels
              wiltPoint = wiltPoint, #Wilting point in m^3/m^3? need to convert to mm per meter with rooting depth?
              fieldCap =fieldCap,#Field capacity
              satPoint= satPoint, #field saturation point
              K_s=K_s, #Soil conductivity
              shared_area=shared_area, #shared area of rooting and non-rooting zone
              V_nr=V_nr, #Volume of non-rooting zone
              maxRootDepth=maxRootDepth,
              sigma_zR =sigma_zR, #area/depth explored by 1kg of root biomass
              SWC_nr=SWC_nr, #SWC of non-rooting zone at time 0
              E_S1 =E_S1, #Cumulitive evap threshold (kg^m-2) - sensitive to length of time-step, e.g. monthly time-step means wetting event only occurs at end of month
              E_S2 =E_S2, #how quickly evaporation rate declines with accumulated phase 2 evaporation - based on soil structure
              MaxASW_state=MaxASW_state,
              K_drain=K_drain,
              timeStp = timeStp, # time step, 52 for weekly, 12 for monthly and 365 for daily
      rainMod=rainMod,
      tempMod=tempMod,
      fsMod=fsMod,
      startN=startN,
      startC=startC,
      pseudo=pseudo
  )
}




###get parameters
getParmsPine<-function(weather=clm_df_pine,
                   ## ~~ Initial pools ~~ ##
                   Wl = 0.01,
                   WlDormant = 0,
                   Wr = 0.01,
                   Wsbr = 0.1,
                   Wlitt = 0,# could be real small?
                   YrC = 47.97,
                   YlC = 95.94,
                   OC = 335.78,
                   YrN = 2.02,
                   YlN = 4.05,
                   ON = 14.7,
                   Nav = 12.4,
                   ## ~~ Site ~~ ##
                   N = 2250,
                   rotation = 1,
                   cycle = 1,
                   rm.sprouts = F,
                   nyears = 35,
                   initial.month = 1,
                   latitude = 57.06,
                   soilclass = -1,
                   ASW = 165,
                   MaxASW = 500,
                   MinASW = 0,
                   CO2 = 400,
                   ## ~~ Parameters ~~ ##
                   pFS2 = 0.73,
                   pFS20 = 0.20,
                   aS = 0.0215,
                   nS = 2.7184,
                   pRx = 0.5,
                   pRn = 0.25,
                   Tmin = -5,
                   Topt = 15,
                   Tmax = 35,
                   kF = 1,
                   SWconst0 = 0.65,
                   SWpower0 = 8,
                   m0 = 0.015,
                   MaxAge = 265.6,
                   nAge = 4,
                   rAge = 0.95,
                   gammaFx = 0.025,
                   gammaF0 = 0.001,
                   tgammaF = 36,
                   Rttover = 0.2,
                   MaxCond = 0.02,
                   LAIgcx = 3.33,
                   BLcond = 0.2,
                   wSx1000 = 500,
                   thinPower = 1.5,
                   mF = 0.633672385962458,
                   mR = 0.2,
                   mS = 0.2,
                   SLA0 = 6,
                   SLA1 = 4,
                   tSLA = 6,
                   k = 0.6,
                   fullCanAge = 14,
                   MaxIntcptn = 0.15,
                   LAImaxIntcptn = 5,
                   alpha = 0.05,
                   Y = 0.47,
                   poolFractn = 0,
                   e20 = 2.2,
                   rhoAir = 1.2,
                   lambda = 2450000,
                   VPDconv = 0.000622,
                   fracBB0 = 0.15,
                   fracBB1 = 0.1,
                   tBB = 20,
                   rhoMin = 0.39,
                   rhoMax = 0.39,
                   tRho = 5,
                   Qa = -90,
                   Qb = 0.9,
                   gDM_mol = 24,
                   molPAR_MJ = 2.3,
                   CoeffCond = 0.05,
                   fCalpha700 = 1.433,
                   fCg700 = 0.451,
                   fCalphax = 2.33333333333333,
                   fCg0 = 1.75,
                   MinCond = 0.01,
                   klmax = 0.06903041028657,
                   krmax = 0.007021449543068,
                   komax = 0.00840935020844,
                   hc = 0.494539540825284,
                   qir = 148.092408851735,
                   qil = 14.9377246340992,
                   qh = 40.4572399963215,
                   qbc = 7.00578471546651,
                   el = 0.739904866285297,
                   er = 0.769592209202898,
                   Nf = 0.0196791366844,
                   Navm = 0.032129816636208,
                   Navx = 8.75614468799907,
                   leaf.grow = 0,
                   leaf.fall = 0,
                   Wl.s = 0.01,
                   Wsbr.s = 0.1,
                   Wr.s = 0.01,
                   pWl.sprouts = 0.5,
                   pWsbr.sprouts = 0.9,
                   cod.pred = "3PG",
                   cod.clim = "Month",
                   ## ~~ Almedia et al. Parameters ~~ ##
                   waterBalanceSubMods =T, #Whether to run model using updated water balance submodels
                   wiltPoint = 0.14, #Wilting point in m^3/m^3? need to convert to mm per meter with rooting depth?
                   fieldCap =0.45,#Field capacity
                   satPoint= 0.65, #field saturation point
                   K_s=12, #Soil conductivity
                   shared_area=4, #shared area of rooting and non-rooting zone
                   V_nr=3, #Volume of non-rooting zone
                   maxRootDepth=2.5,
                   sigma_zR =0.5, #area/depth explored by 1kg of root biomass
                   SWC_nr=10, #SWC of non-rooting zone at time 0
                   E_S1 =2.5, #Cumulitive evap threshold (kg^m-2) - sensitive to length of time-step, e.g. monthly time-step means wetting event only occurs at end of month
                   E_S2 =1.5, #how quickly evaporation rate declines with accumulated phase 2 evaporation - based on soil structure
                   MaxASW_state=50,
                   K_drain=400,
                   timeStp = 12, # time step, 52 for weekly, 12 for monthly and 365 for daily
                   rainMod =1, #rain adjustment for sensitivity analyses
                   tempMod =1, #rain adjustment for sensitivity analyses
                   fsMod=1,
                   startN=6,
                   startC=100,
                   pseudo=F
                   
){
  
  list(weather=weather,
       ## ~~ Initial pools ~~ ##
       Wl =Wl ,
       WlDormant =WlDormant ,
       Wr =Wr ,
       Wsbr =Wsbr ,
       Wlitt =Wlitt ,
       YrC =YrC ,
       YlC =YlC ,
       OC =OC ,
       YrN =YrN ,
       YlN =YlN ,
       ON =ON ,
       Nav =Nav ,
       ## ~~ Site ~
       N =N ,
       rotation =rotation ,
       cycle =cycle ,
       rm.sprouts =rm.sprouts ,
       nyears =nyears ,
       initial.month =initial.month ,
       latitude =latitude ,
       soilclass = soilclass,
       ASW =ASW ,
       MaxASW =MaxASW ,
       MinASW =MinASW ,
       CO2 =CO2 ,
       ## ~~ Parameters ~
       pFS2 =pFS2 ,
       pFS20 =pFS20 ,
       aS =aS ,
       nS =nS ,
       pRx =pRx ,
       pRn =pRn ,
       Tmin = Tmin,
       Topt =Topt ,
       Tmax =Tmax ,
       kF =kF ,
       SWconst0 =SWconst0 ,
       SWpower0 =SWpower0 ,
       m0 =m0 ,
       MaxAge =MaxAge ,
       nAge =nAge ,
       rAge =rAge ,
       gammaFx =gammaFx ,
       gammaF0 =gammaF0 ,
       tgammaF =tgammaF ,
       Rttover =Rttover ,
       MaxCond =MaxCond ,
       LAIgcx =LAIgcx ,
       BLcond =BLcond ,
       wSx1000 =wSx1000 ,
       thinPower =thinPower ,
       mF =mF ,
       mR =mR ,
       mS =mS ,
       SLA0 =SLA0 ,
       SLA1 =SLA1 ,
       tSLA =tSLA ,
       k =k ,
       fullCanAge =fullCanAge ,
       MaxIntcptn =MaxIntcptn ,
       LAImaxIntcptn =LAImaxIntcptn ,
       alpha =alpha ,
       Y =Y ,
       poolFractn =poolFractn ,
       e20 =e20 ,
       rhoAir =rhoAir ,
       lambda =lambda ,
       VPDconv =VPDconv ,
       fracBB0 =fracBB0 ,
       fracBB1 =fracBB1 ,
       tBB =tBB ,
       rhoMin =rhoMin ,
       rhoMax =rhoMax ,
       tRho =tRho ,
       Qa = Qa,
       Qb =Qb ,
       gDM_mol =gDM_mol ,
       molPAR_MJ =molPAR_MJ ,
       CoeffCond =CoeffCond ,
       fCalpha700 =fCalpha700 ,
       fCg700 =fCg700 ,
       fCalphax =fCalphax,
       fCg0 =fCg0 ,
       MinCond =MinCond ,
       klmax =klmax ,
       krmax =krmax ,
       komax =komax ,
       hc =hc ,
       qir =qir ,
       qil =qil ,
       qh =qh ,
       qbc =qbc ,
       el =el ,
       er =er ,
       Nf =Nf ,
       Navm =Navm ,
       Navx =Navx ,
       leaf.grow =leaf.grow ,
       leaf.fall =leaf.fall ,
       Wl.s =Wl.s ,
       Wsbr.s =Wsbr.s ,
       Wr.s =Wr.s ,
       pWl.sprouts =pWl.sprouts ,
       pWsbr.sprouts =pWsbr.sprouts ,
       cod.pred = cod.pred,
       cod.clim = cod.clim,
       ## ~~ Almedia et al. Parameters ~~ ##
       waterBalanceSubMods =waterBalanceSubMods, #Whether to run model using updated water balance submodels
       wiltPoint = wiltPoint, #Wilting point in m^3/m^3? need to convert to mm per meter with rooting depth?
       fieldCap =fieldCap,#Field capacity
       satPoint= satPoint, #field saturation point
       K_s=K_s, #Soil conductivity
       shared_area=shared_area, #shared area of rooting and non-rooting zone
       V_nr=V_nr, #Volume of non-rooting zone
       maxRootDepth=maxRootDepth,
       sigma_zR =sigma_zR, #area/depth explored by 1kg of root biomass
       SWC_nr=SWC_nr, #SWC of non-rooting zone at time 0
       E_S1 =E_S1, #Cumulitive evap threshold (kg^m-2) - sensitive to length of time-step, e.g. monthly time-step means wetting event only occurs at end of month
       E_S2 =E_S2, #how quickly evaporation rate declines with accumulated phase 2 evaporation - based on soil structure
       MaxASW_state=MaxASW_state,
       K_drain=K_drain,
       timeStp = timeStp, # time step, 52 for weekly, 12 for monthly and 365 for daily
       rainMod=rainMod,
       tempMod=tempMod,
       fsMod=fsMod,
       startN=startN,
       startC=startC,
       pseudo=pseudo
       
  )
}


